(()=>{"use strict";function t(l,e="",o=!0){null!=l&&(null!==l.right&&t(l.right,`${e}${o?"│   ":"    "}`,!1),console.log(`${e}${o?"└── ":"┌── "}${l.data}`),null!==l.left&&t(l.left,`${e}${o?"    ":"│   "}`,!0))}class l{constructor(t){this.data=t,this.right=null,this.left=null}}function e(t,o,n){if(o>n)return null;let r=Math.floor((o+n)/2),h=new l(t[r]);return h.left=e(t,o,r-1),h.right=e(t,r+1,n),h}function o(t){return t&&t.data?Math.max(1+o(t.right),1+o(t.left)):0}function n(t,l){return l&&l.data?l.data==t.data?0:t.data>l.data?1+n(t,l=l.right):1+n(t,l=l.left):0}function r(t){if(null==t||null==t.data)return!0;let l=o(t.left),e=o(t.right);return Math.abs(l-e)<=1&&r(t.left)&&r(t.right)}let h=[];function i(t){if(console.log("arr = "+h),null==t||null==t.data||null==t)return console.log("returned arr = "+h),h;h.push(t.data),null!=t.left&&null!=t.left&&i(t.left),null!=t.right&&null!=t.right&&i(t.right)}let a=[4,5,3,4,1,23,1,4,7,8,7];console.log(a),a=function(t){t.sort((function(t,l){return t-l}));let l=t.length,e=[];e.push(t[0]);for(let o=1;o<l;o++)t[o]!=t[o-1]&&e.push(t[o]);return e}(a),console.log(a);let s=new class{constructor(t){console.log("before"),this.root=e(t,0,t.length-1),console.log("after")}insert(t,e=this.root){return null==e||e.data==t?(console.log(e),e=new l(t)):(parseInt(t)>parseInt(e.data)?e.right=this.insert(t,e.right):e.left=this.insert(t,e.left),e)}delete(t,l=this.root){if(null==l)return l;if(l.data>t)return l.left=this.delete(t,l.left),l;if(l.data<t)return l.right=this.delete(t,l.right),l;if(null==l.left&&null!=l.right)return l.right;if(null==l.right&&null!=l.left)return l.left;if(null!=l.right&&null!=l.left){const t=this.findSuccessor(l.right);return l.data=t.data,l.right=this.delete(t.data,l.right),l}}find(t){let l=this.root;for(;null!=l&&l.data!=t;)l=t>l.data?l.right:l.left;return l}graph(){console.log(this.root),t(this.root)}findSuccessor(t){let l=t;for(;null!=l.left;)l=l.left;return l}levelOrder(t=this.root){if(null==t||null==t.data)return null;let l=[];for(l.push(t);0!==l.length;){let t=l[0];console.log(t.data),null!=t.left&&l.push(t.left),null!=t.right&&l.push(t.right),l.shift()}return null}}(a);s.graph(),s.insert(77),s.insert(11),s.graph(),s.delete(1),s.graph(),s.delete(8),s.graph(),s.delete(11),s.graph(),console.log(s.find(77)),s.levelOrder(s.node),console.log("===================================="),function t(l){if(null==l||null==l.data)return null;t(l.left),console.log(l.data),t(l.right)}(s.root),console.log("===================================="),function t(l){null!=l&&null!=l.data&&(console.log(l.data),t(l.left),t(l.right))}(s.root),console.log("===================================="),function t(l){l&&l.data&&(t(l.left),t(l.right),console.log(l.data))}(s.root),console.log("The Height of the tree = "+o(s.root)),console.log("The height of node 23 = "+o(s.find(23))),console.log("The height of node 4 = "+o(s.find(4))),console.log("The height of node 8 = "+s.find(8)),s.graph(),console.log("The Depth of the node 77 = "+n(s.find(77),s.root)),console.log("The Depth of the node 4 = "+n(s.find(4),s.root)),console.log("The Depth of the node 3 = "+n(s.find(3),s.root)),console.log("The Depth of the node 5 = "+n(s.find(5),s.root)),s.insert(100),s.graph(),console.log(r(s.root)),1==r(s.root)?console.log("The tree is balanced :)"):console.log("The tree is not balanced :("),s.insert(200),s.graph(),console.log(r(s.root)),1==r(s.root)?console.log("The tree is balanced :)"):console.log("The tree is not balanced :("),s.root=function(t){h.length=0;let l=i(t);return console.log(h),console.log(l),e(h,0,h.length-1)}(s.root),s.graph()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUtoQixNQUNmakIsUUFBUUMsSUFBSSwyQkFFWkQsUUFBUUMsSUFBSSwrQkFJaEJnQyxFQUFLQyxPQUFPLEtBRVpELEVBQUtPLFFBRUx4QyxRQUFRQyxJQUFJaUIsRUFBV2UsRUFBS2hCLE9BRUEsR0FBekJDLEVBQVdlLEVBQUtoQixNQUNmakIsUUFBUUMsSUFBSSwyQkFFWkQsUUFBUUMsSUFBSSwrQkFLaEJnQyxFQUFLaEIsS0Q1R0wsU0FBbUJBLEdBRWZULEVBQUlxQixPQUFTLEVBR2IsSUFBSUMsRUFBU1IsRUFBU0wsR0FHdEIsT0FGQWpCLFFBQVFDLElBQUlPLEdBQ1pSLFFBQVFDLElBQUk2QixHQUNMLEVBQU10QixFQUFLLEVBQUdBLEVBQUlxQixPQUFPLEVBQ3BDLENDbUdZbUIsQ0FBVWYsRUFBS2hCLE1BRTNCZ0IsRUFBS08sTyIsInNvdXJjZXMiOlsid2VicGFjazovL2Fzc2lnbm1lbnQtYnN0Ly4vc3JjL3ByZXR0eVByaW50LmpzIiwid2VicGFjazovL2Fzc2lnbm1lbnQtYnN0Ly4vc3JjL25vZGUuanMiLCJ3ZWJwYWNrOi8vYXNzaWdubWVudC1ic3QvLi9zcmMvdG9CU1QuanMiLCJ3ZWJwYWNrOi8vYXNzaWdubWVudC1ic3QvLi9zcmMvaGVpZ2h0LmpzIiwid2VicGFjazovL2Fzc2lnbm1lbnQtYnN0Ly4vc3JjL2RlcHRoLmpzIiwid2VicGFjazovL2Fzc2lnbm1lbnQtYnN0Ly4vc3JjL2lzQmFsYW5jZWQuanMiLCJ3ZWJwYWNrOi8vYXNzaWdubWVudC1ic3QvLi9zcmMvcmViYWxhbmNlLmpzIiwid2VicGFjazovL2Fzc2lnbm1lbnQtYnN0Ly4vc3JjL2luZGV4LmpzIiwid2VicGFjazovL2Fzc2lnbm1lbnQtYnN0Ly4vc3JjL3RyZWUuanMiLCJ3ZWJwYWNrOi8vYXNzaWdubWVudC1ic3QvLi9zcmMvaW5PcmRlci5qcyIsIndlYnBhY2s6Ly9hc3NpZ25tZW50LWJzdC8uL3NyYy9wcmVPcmRlci5qcyIsIndlYnBhY2s6Ly9hc3NpZ25tZW50LWJzdC8uL3NyYy9wb3N0T3JkZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiXHJcblxyXG5cclxuXHJcbmZ1bmN0aW9uIHByZXR0eVByaW50IChub2RlLCBwcmVmaXggPSBcIlwiLCBpc0xlZnQgPSB0cnVlKSB7XHJcbiAgICAvLyBjb25zb2xlLmxvZyhub2RlKTtcclxuICAgIGlmIChub2RlID09IG51bGwpIHsgICAgXHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGlmIChub2RlLnJpZ2h0ICE9PSBudWxsKSB7XHJcbiAgICAgIHByZXR0eVByaW50KG5vZGUucmlnaHQsIGAke3ByZWZpeH0ke2lzTGVmdCA/IFwi4pSCICAgXCIgOiBcIiAgICBcIn1gLCBmYWxzZSk7XHJcbiAgICB9XHJcbiAgICBjb25zb2xlLmxvZyhgJHtwcmVmaXh9JHtpc0xlZnQgPyBcIuKUlOKUgOKUgCBcIiA6IFwi4pSM4pSA4pSAIFwifSR7bm9kZS5kYXRhfWApO1xyXG4gICAgaWYgKG5vZGUubGVmdCAhPT0gbnVsbCkge1xyXG4gICAgICBwcmV0dHlQcmludChub2RlLmxlZnQsIGAke3ByZWZpeH0ke2lzTGVmdCA/IFwiICAgIFwiIDogXCLilIIgICBcIn1gLCB0cnVlKTtcclxuICAgIH1cclxufTtcclxuXHJcblxyXG5leHBvcnQgeyBwcmV0dHlQcmludCB9OyIsIlxyXG5cclxuXHJcbmNsYXNzIE5vZGUge1xyXG4gICAgY29uc3RydWN0b3IodmFsKSB7XHJcbiAgICAgICAgdGhpcy5kYXRhID0gdmFsO1xyXG4gICAgICAgIHRoaXMucmlnaHQgPSBudWxsO1xyXG4gICAgICAgIHRoaXMubGVmdCA9IG51bGw7XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCB7IE5vZGUgfTtcclxuIiwiaW1wb3J0IHsgTm9kZSB9IGZyb20gJy4vbm9kZSc7XHJcblxyXG5cclxuZnVuY3Rpb24gdG9CU1QoYXJyLCBzdGFydCwgZW5kKSB7XHJcbiAgICBpZihzdGFydCA+IGVuZCkge1xyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG5cclxuICAgIGxldCBtaWQgPSBNYXRoLmZsb29yKChzdGFydCArIGVuZCkgLyAyKTtcclxuXHJcbiAgICBsZXQgbm9kZSA9IG5ldyBOb2RlKGFyclttaWRdKTtcclxuXHJcbiAgICBub2RlLmxlZnQgPSB0b0JTVChhcnIsIHN0YXJ0LCBtaWQtMSk7XHJcbiAgICBub2RlLnJpZ2h0ID0gdG9CU1QoYXJyLCBtaWQrMSwgZW5kKTtcclxuXHJcbiAgICByZXR1cm4gbm9kZTtcclxufVxyXG5cclxuXHJcbmV4cG9ydCB7IHRvQlNUIH07IiwiXHJcblxyXG5mdW5jdGlvbiBoZWlnaHQobm9kZSkge1xyXG4gICAgaWYoIW5vZGUgfHwgIW5vZGUuZGF0YSlcclxuICAgICAgICByZXR1cm4gMDtcclxuICAgIFxyXG4gICAgcmV0dXJuIE1hdGgubWF4KDEgKyBoZWlnaHQobm9kZS5yaWdodCksIDEgKyBoZWlnaHQobm9kZS5sZWZ0KSk7XHJcbn1cclxuXHJcbmV4cG9ydCB7IGhlaWdodCB9OyIsIlxyXG5cclxuXHJcbmZ1bmN0aW9uIGRlcHRoKG5vZGUsIHJvb3QpIHtcclxuICAgIC8vIGZpbmQgdGhlIGRlcHRoIG9mIHRoZSBub2RlID09PiBudW1iZXIgb2YgZWRnZXMgaW4gcGF0aCBmcm9tIHRoaXMgbm9kZSB0byB0cmVlJ3Mgcm9vdCBub2RlXHJcbiAgICBcclxuICAgIC8vIFdlIHdpbGwgbW92ZSB0aGUgcm9vdCBub2RlIHRvIHJlYWNoIHRoZSB0YXJnZXR0ZWQgbm9kZSBcclxuICAgIGlmKCFyb290IHx8ICFyb290LmRhdGEpIHtcclxuICAgICAgICByZXR1cm4gMDtcclxuICAgIH1cclxuICAgIGlmKHJvb3QuZGF0YSA9PSBub2RlLmRhdGEpIHtcclxuICAgICAgICByZXR1cm4gMDtcclxuICAgIH0gICAgXHJcbiAgICBcclxuICAgIGlmKG5vZGUuZGF0YSA+IHJvb3QuZGF0YSkge1xyXG4gICAgICAgIHJvb3QgPSByb290LnJpZ2h0O1xyXG4gICAgICAgIHJldHVybiAxICsgZGVwdGgobm9kZSwgcm9vdCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIHJvb3QgPSByb290LmxlZnQ7XHJcbiAgICAgICAgcmV0dXJuIDEgKyBkZXB0aChub2RlLCByb290KTtcclxuICAgIH1cclxuICAgIFxyXG59XHJcblxyXG5cclxuZXhwb3J0IHsgZGVwdGggfTsiLCIvLyBpbXBvcnQgeyBoZWlnaHQgfSBmcm9tICcuL2hlaWdodCc7XHJcblxyXG5cclxuXHJcbi8vIGZ1bmN0aW9uIGlzQmFsYW5jZWQobm9kZSkge1xyXG4vLyAgICAgLy8gY2FsY3VsYXRlIHRoZSBoZWlnaHQgb2YgdGhlIGxlZnQgc3ViVHJlZSAmIHRoZSByaWdodCBzdWJUcmVlXHJcbi8vICAgICAvLyBpZiB0aGUgZGlmZmVyZW5jZSBiZXR3ZWVuIHRoZW0gaXMgYXQgbW9zdCAxXHJcbi8vICAgICAgICAgLy8gT2ssIGNoZWNrIGl0cyBjaGlsZHJlbiBhcyB3ZWxsXHJcbi8vICAgICAvLyBvdGhlcndpc2VcclxuLy8gICAgICAgICAvLyBpdCdzIG5vdCA9PT4gcmV0dXJuIGZhbHNlLlxyXG5cclxuLy8gICAgIGxldCBoZWlnaHQxID0gaGVpZ2h0KG5vZGUubGVmdCk7XHJcbi8vICAgICBsZXQgaGVpZ2h0MiA9IGhlaWdodChub2RlLnJpZ2h0KTtcclxuLy8gICAgIGNvbnNvbGUubG9nKFwiaGVpZ2h0IDEgXCIgKyBoZWlnaHQxKTtcclxuLy8gICAgIGNvbnNvbGUubG9nKFwiaGVpZ2h0IDIgXCIgKyBoZWlnaHQyKTtcclxuLy8gICAgIGNvbnNvbGUubG9nKFwiZGlmZiA9IFwiICsgTWF0aC5hYnMoaGVpZ2h0MSAtIGhlaWdodDIpKTtcclxuLy8gICAgIHJldHVybiAoTWF0aC5hYnMoaGVpZ2h0MSAtIGhlaWdodDIpIDw9IDEpO1xyXG4vLyB9XHJcblxyXG5cclxuLy8gZXhwb3J0IHsgaXNCYWxhbmNlZCB9OyAgXHJcblxyXG5pbXBvcnQgeyBoZWlnaHQgfSBmcm9tICcuL2hlaWdodCc7XHJcblxyXG5cclxuXHJcbmZ1bmN0aW9uIGlzQmFsYW5jZWQobm9kZSkge1xyXG4gICAgLy8gY2FsY3VsYXRlIHRoZSBoZWlnaHQgb2YgdGhlIGxlZnQgc3ViVHJlZSAmIHRoZSByaWdodCBzdWJUcmVlXHJcbiAgICAvLyBpZiB0aGUgZGlmZmVyZW5jZSBiZXR3ZWVuIHRoZW0gaXMgYXQgbW9zdCAxXHJcbiAgICAgICAgLy8gT2ssIGNoZWNrIGl0cyBjaGlsZHJlbiBhcyB3ZWxsXHJcbiAgICAvLyBvdGhlcndpc2VcclxuICAgICAgICAvLyBpdCdzIG5vdCA9PT4gcmV0dXJuIGZhbHNlLlxyXG5cclxuICAgIGlmKG5vZGUgPT0gbnVsbCB8fCBub2RlLmRhdGEgPT0gbnVsbCkge1xyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfVxyXG5cclxuICAgIGxldCBoZWlnaHQxID0gaGVpZ2h0KG5vZGUubGVmdCk7XHJcbiAgICBsZXQgaGVpZ2h0MiA9IGhlaWdodChub2RlLnJpZ2h0KTtcclxuXHJcbiAgICBpZihNYXRoLmFicyhoZWlnaHQxIC0gaGVpZ2h0MikgPD0gMSkge1xyXG4gICAgICAgIHJldHVybiAoaXNCYWxhbmNlZChub2RlLmxlZnQpICYmIGlzQmFsYW5jZWQobm9kZS5yaWdodCkpXHJcbiAgICB9IFxyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG5cclxuICAgIC8vIGNvbnNvbGUubG9nKFwiaGVpZ2h0IDEgXCIgKyBoZWlnaHQxKTtcclxuICAgIC8vIGNvbnNvbGUubG9nKFwiaGVpZ2h0IDIgXCIgKyBoZWlnaHQyKTtcclxuICAgIC8vIGNvbnNvbGUubG9nKFwiZGlmZiA9IFwiICsgTWF0aC5hYnMoaGVpZ2h0MSAtIGhlaWdodDIpKTtcclxuICAgIC8vIHJldHVybiAoTWF0aC5hYnMoaGVpZ2h0MSAtIGhlaWdodDIpIDw9IDEpO1xyXG59XHJcblxyXG5cclxuZXhwb3J0IHsgaXNCYWxhbmNlZCB9OyIsImltcG9ydCB7IHRvQlNUICB9IGZyb20gXCIuL3RvQlNUXCI7XHJcblxyXG5cclxubGV0IGFyciA9IFtdO1xyXG5cclxuZnVuY3Rpb24gdHJhdmVyc2Uobm9kZSkge1xyXG4gICAgY29uc29sZS5sb2coXCJhcnIgPSBcIiArIGFycik7XHJcbiAgICBpZihub2RlID09IG51bGwgfHwgbm9kZS5kYXRhID09IG51bGwgfHwgbm9kZSA9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhcInJldHVybmVkIGFyciA9IFwiICsgYXJyKTtcclxuICAgICAgICByZXR1cm4gYXJyO1xyXG4gICAgfSBcclxuICAgIGFyci5wdXNoKG5vZGUuZGF0YSk7XHJcbiAgICBpZihub2RlLmxlZnQgIT0gbnVsbCAmJiBub2RlLmxlZnQgIT0gdW5kZWZpbmVkKVxyXG4gICAgICAgIHRyYXZlcnNlKG5vZGUubGVmdCk7XHJcbiAgICBpZihub2RlLnJpZ2h0ICE9IG51bGwgJiYgbm9kZS5yaWdodCAhPSB1bmRlZmluZWQpXHJcbiAgICAgICAgdHJhdmVyc2Uobm9kZS5yaWdodCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHJlYmFsYW5jZShyb290KSB7XHJcbiAgICAvLyBDbGVhciB0aGUgYXJyYXlcclxuICAgIGFyci5sZW5ndGggPSAwO1xyXG5cclxuICAgIC8vIEZpbGwgdGhlIGFycmF5IHdpdGggdGhlIG5vZGVzIG9mIHRoZSB0cmVlXHJcbiAgICBsZXQgbmV3QXJyID0gdHJhdmVyc2Uocm9vdCk7XHJcbiAgICBjb25zb2xlLmxvZyhhcnIpO1xyXG4gICAgY29uc29sZS5sb2cobmV3QXJyKTtcclxuICAgIHJldHVybiB0b0JTVChhcnIsIDAsIGFyci5sZW5ndGgtMSk7XHJcbn1cclxuXHJcblxyXG5leHBvcnQgeyByZWJhbGFuY2UgfTsiLCJpbXBvcnQgeyBOb2RlIH0gZnJvbSAnLi9ub2RlJztcclxuaW1wb3J0IHsgdG9CU1QgfSBmcm9tICcuL3RvQlNUJztcclxuaW1wb3J0IHsgVHJlZSB9IGZyb20gJy4vdHJlZSc7XHJcbmltcG9ydCB7IGluT3JkZXIgfSBmcm9tICcuL2luT3JkZXInO1xyXG5pbXBvcnQgeyBwcmVPcmRlciB9IGZyb20gJy4vcHJlT3JkZXInO1xyXG5pbXBvcnQgeyBwb3N0T3JkZXIgfSBmcm9tICcuL3Bvc3RPcmRlcic7XHJcbmltcG9ydCB7IGhlaWdodCB9IGZyb20gJy4vaGVpZ2h0JztcclxuaW1wb3J0IHsgZGVwdGggfSBmcm9tICcuL2RlcHRoJztcclxuaW1wb3J0IHsgaXNCYWxhbmNlZCB9IGZyb20gJy4vaXNCYWxhbmNlZCc7XHJcbmltcG9ydCB7IHJlYmFsYW5jZSB9IGZyb20gJy4vcmViYWxhbmNlJztcclxuXHJcbmZ1bmN0aW9uIHNvcnRBbmRSZW1vdmVEdXBsaWNhdGVzKGFycikge1xyXG4gICAgLy8gU29ydCB0aGUgYXJyYXlcclxuICAgIGFyci5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7IHJldHVybiBhIC0gYiB9KTtcclxuICAgIC8vIHJlbW92ZSBkdXBsaWNhdGVzXHJcbiAgICBsZXQgbiA9IGFyci5sZW5ndGg7XHJcbiAgICBsZXQgbmV3QXJyID0gW107XHJcbiAgICBuZXdBcnIucHVzaChhcnJbMF0pO1xyXG4gICAgZm9yKGxldCBpPTE7IGk8bjsgaSsrKSB7XHJcbiAgICAgICAgaWYoYXJyW2ldICE9IGFycltpLTFdKVxyXG4gICAgICAgICAgICBuZXdBcnIucHVzaChhcnJbaV0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIGNvbnNvbGUubG9nKG5ld0Fycik7XHJcblxyXG4gICAgcmV0dXJuIG5ld0FycjtcclxufVxyXG5cclxuXHJcbmZ1bmN0aW9uIGJ1aWxkVHJlZShhcnIpIHtcclxuICAgIGFyciA9IHNvcnRBbmRSZW1vdmVEdXBsaWNhdGVzKGFycik7XHJcbiAgICBcclxuICAgIGxldCByb290ID0gdG9CU1QoYXJyLCAwLCBhcnIubGVuZ3RoLTEpO1xyXG5cclxuICAgIC8vIHByZXR0eVByaW50KHJvb3QpO1xyXG5cclxuICAgIHJldHVybiByb290O1xyXG59XHJcblxyXG5cclxuZnVuY3Rpb24gZGlzcChub2RlKSB7XHJcbiAgICBpZihub2RlID09IG51bGwpXHJcbiAgICAgICAgcmV0dXJuO1xyXG5cclxuICAgIHRoaXMuZGlzcChub2RlLmxlZnQpO1xyXG4gICAgY29uc29sZS5sb2cobm9kZS5kYXRhKTtcclxuICAgIHRoaXMuZGlzcChub2RlLnJpZ2h0KTtcclxuXHJcbiAgICByZXR1cm4gbm9kZTtcclxufVxyXG5cclxubGV0IGFyciA9IFs0LCA1LCAzLCA0LCAxLCAyMywgMSwgNCwgNywgOCwgN107XHJcbmNvbnNvbGUubG9nKGFycik7XHJcbmFyciA9IHNvcnRBbmRSZW1vdmVEdXBsaWNhdGVzKGFycik7XHJcbmNvbnNvbGUubG9nKGFycik7XHJcbi8vIGJ1aWxkVHJlZShhcnIpO1xyXG5sZXQgdHJlZSA9IG5ldyBUcmVlKGFycik7XHJcbnRyZWUuZ3JhcGgoKTtcclxuLy8gY29uc29sZS5sb2codHJlZS5yb290KTtcclxudHJlZS5pbnNlcnQoNzcpO1xyXG50cmVlLmluc2VydCgxMSk7XHJcbi8vIHRyZWUuaW5zZXJ0KDApO1xyXG50cmVlLmdyYXBoKCk7XHJcblxyXG50cmVlLmRlbGV0ZSgxKTtcclxudHJlZS5ncmFwaCgpO1xyXG5cclxudHJlZS5kZWxldGUoOCk7XHJcbnRyZWUuZ3JhcGgoKTtcclxuXHJcbnRyZWUuZGVsZXRlKDExKTtcclxudHJlZS5ncmFwaCgpO1xyXG5cclxuXHJcbmNvbnNvbGUubG9nKHRyZWUuZmluZCg3NykpO1xyXG4vLyBjb25zb2xlLmxvZyh0cmVlLmZpbmQoMSkpO1xyXG4vLyBjb25zb2xlLmxvZyh0cmVlLmZpbmQoMjMpKTtcclxuXHJcblxyXG50cmVlLmxldmVsT3JkZXIodHJlZS5ub2RlKTtcclxuY29uc29sZS5sb2coJz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PScpO1xyXG5pbk9yZGVyKHRyZWUucm9vdCk7XHJcbmNvbnNvbGUubG9nKCc9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0nKTtcclxucHJlT3JkZXIodHJlZS5yb290KTtcclxuY29uc29sZS5sb2coJz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PScpO1xyXG5wb3N0T3JkZXIodHJlZS5yb290KTtcclxuXHJcbmNvbnNvbGUubG9nKFwiVGhlIEhlaWdodCBvZiB0aGUgdHJlZSA9IFwiICsgaGVpZ2h0KHRyZWUucm9vdCkpOyAgICAgICAvLyAzXHJcbmNvbnNvbGUubG9nKCdUaGUgaGVpZ2h0IG9mIG5vZGUgMjMgPSAnICsgaGVpZ2h0KHRyZWUuZmluZCgyMykpKTsgICAgLy8gMlxyXG5jb25zb2xlLmxvZygnVGhlIGhlaWdodCBvZiBub2RlIDQgPSAnICsgaGVpZ2h0KHRyZWUuZmluZCg0KSkpOyAgICAgIC8vIDFcclxuY29uc29sZS5sb2coJ1RoZSBoZWlnaHQgb2Ygbm9kZSA4ID0gJyArIHRyZWUuZmluZCg4KSk7ICAgICAgICAgICAgICAvLyBudWxsXHJcblxyXG50cmVlLmdyYXBoKCk7XHJcblxyXG5jb25zb2xlLmxvZyhcIlRoZSBEZXB0aCBvZiB0aGUgbm9kZSA3NyA9IFwiICsgZGVwdGgodHJlZS5maW5kKDc3KSwgdHJlZS5yb290KSk7IFxyXG5jb25zb2xlLmxvZyhcIlRoZSBEZXB0aCBvZiB0aGUgbm9kZSA0ID0gXCIgKyBkZXB0aCh0cmVlLmZpbmQoNCksIHRyZWUucm9vdCkpOyBcclxuY29uc29sZS5sb2coXCJUaGUgRGVwdGggb2YgdGhlIG5vZGUgMyA9IFwiICsgZGVwdGgodHJlZS5maW5kKDMpLCB0cmVlLnJvb3QpKTsgXHJcbmNvbnNvbGUubG9nKFwiVGhlIERlcHRoIG9mIHRoZSBub2RlIDUgPSBcIiArIGRlcHRoKHRyZWUuZmluZCg1KSwgdHJlZS5yb290KSk7IFxyXG5cclxudHJlZS5pbnNlcnQoMTAwKTtcclxuLy8gdHJlZS5pbnNlcnQoMTAxKTtcclxudHJlZS5ncmFwaCgpO1xyXG5cclxuY29uc29sZS5sb2coaXNCYWxhbmNlZCh0cmVlLnJvb3QpKTtcclxuXHJcbmlmKGlzQmFsYW5jZWQodHJlZS5yb290KSA9PSAxKSB7XHJcbiAgICBjb25zb2xlLmxvZyhcIlRoZSB0cmVlIGlzIGJhbGFuY2VkIDopXCIpO1xyXG59IGVsc2Uge1xyXG4gICAgY29uc29sZS5sb2coXCJUaGUgdHJlZSBpcyBub3QgYmFsYW5jZWQgOihcIik7XHJcbn1cclxuXHJcblxyXG50cmVlLmluc2VydCgyMDApO1xyXG4vLyB0cmVlLmluc2VydCgxMDEpO1xyXG50cmVlLmdyYXBoKCk7XHJcblxyXG5jb25zb2xlLmxvZyhpc0JhbGFuY2VkKHRyZWUucm9vdCkpO1xyXG5cclxuaWYoaXNCYWxhbmNlZCh0cmVlLnJvb3QpID09IDEpIHtcclxuICAgIGNvbnNvbGUubG9nKFwiVGhlIHRyZWUgaXMgYmFsYW5jZWQgOilcIik7XHJcbn0gZWxzZSB7XHJcbiAgICBjb25zb2xlLmxvZyhcIlRoZSB0cmVlIGlzIG5vdCBiYWxhbmNlZCA6KFwiKTtcclxufVxyXG5cclxuXHJcblxyXG50cmVlLnJvb3QgPSByZWJhbGFuY2UodHJlZS5yb290KTtcclxuXHJcbnRyZWUuZ3JhcGgoKTsiLCJpbXBvcnQgeyBwcmV0dHlQcmludCB9IGZyb20gXCIuL3ByZXR0eVByaW50XCI7XHJcbmltcG9ydCB7IE5vZGUgfSBmcm9tICcuL25vZGUnO1xyXG5pbXBvcnQgeyB0b0JTVCB9IGZyb20gJy4vdG9CU1QnO1xyXG5cclxuLy8gY29uc3QgeyB0b0JTVCB9ID0gcmVxdWlyZShcIi4vdG9CU1RcIik7XHJcblxyXG5cclxuY2xhc3MgVHJlZSB7XHJcbiAgICBjb25zdHJ1Y3RvcihhcnIpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhcImJlZm9yZVwiKTtcclxuICAgICAgICB0aGlzLnJvb3QgPSB0b0JTVChhcnIsIDAsIGFyci5sZW5ndGgtMSk7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJhZnRlclwiKTtcclxuICAgIH1cclxuXHJcbiAgICBpbnNlcnQodmFsLCBub2RlID0gdGhpcy5yb290KSB7XHJcbiAgICAgICAgLy8gY29uc29sZS5sb2cobm9kZSk7XHJcbiAgICAgICAgaWYobm9kZSA9PSBudWxsIHx8IG5vZGUuZGF0YSA9PSB2YWwpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2cobm9kZSk7XHJcbiAgICAgICAgICAgIG5vZGUgPSBuZXcgTm9kZSh2YWwpO1xyXG4gICAgICAgICAgICByZXR1cm4gbm9kZTsgICBcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmKHBhcnNlSW50KHZhbCkgPiBwYXJzZUludChub2RlLmRhdGEpKSB7XHJcbiAgICAgICAgICAgIG5vZGUucmlnaHQgPSB0aGlzLmluc2VydCh2YWwsIG5vZGUucmlnaHQpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIG5vZGUubGVmdCA9IHRoaXMuaW5zZXJ0KHZhbCwgbm9kZS5sZWZ0KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBub2RlO1xyXG4gICAgfVxyXG5cclxuICAgIGRlbGV0ZSh2YWwsIG5vZGUgPSB0aGlzLnJvb3QpIHtcclxuICAgICAgICAvLyBCYXNlIENhc2U6XHJcbiAgICAgICAgaWYobm9kZSA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBub2RlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gUmVjdXJzaXZsZSBjYWxscyBmb3IgYW5jZXN0b3JzIG9mIG5vZGUgdG8gYmUgZGVsZXRlZC5cclxuICAgICAgICBpZihub2RlLmRhdGEgPiB2YWwpIHtcclxuICAgICAgICAgICAgbm9kZS5sZWZ0ID0gdGhpcy5kZWxldGUodmFsLCBub2RlLmxlZnQpO1xyXG4gICAgICAgICAgICByZXR1cm4gbm9kZTtcclxuICAgICAgICB9IGVsc2UgaWYobm9kZS5kYXRhIDwgdmFsKSB7XHJcbiAgICAgICAgICAgIG5vZGUucmlnaHQgPSB0aGlzLmRlbGV0ZSh2YWwsIG5vZGUucmlnaHQpO1xyXG4gICAgICAgICAgICByZXR1cm4gbm9kZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIFdlIHJlYWNoIGhlcmUgaWYgdGhlIG5vZGUgaXMgdGhlIG5vZGUgdG8gYmUgZGVsZXRlZC4uXHJcblxyXG4gICAgICAgIC8vIFRoZXJlIGFyZSBtb3JlIHRoYW4gb25lIHNjZW5hcmlvIFxyXG4gICAgICAgIC8vIDEtIGlmIHRoZSBub2RlIGhhcyBqdXN0IG9uZSBjaGlsZFxyXG4gICAgICAgIC8vIG1ha2UgdGhlIG5vZGUgcG9pbnRzIHRvIGl0cyByaWdodCBvciBsZWZ0IGNoaWxkXHJcbiAgICAgICAgaWYobm9kZS5sZWZ0ID09IG51bGwgJiYgbm9kZS5yaWdodCAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIG5vZGUgPSBub2RlLnJpZ2h0O1xyXG4gICAgICAgICAgICByZXR1cm4gbm9kZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYobm9kZS5yaWdodCA9PSBudWxsICYmIG5vZGUubGVmdCAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIG5vZGUgPSBub2RlLmxlZnQ7XHJcbiAgICAgICAgICAgIHJldHVybiBub2RlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gMi0gSWYgdGhlIG5vZGUgaGFzIHR3byBjaGlsZHJlblxyXG4gICAgICAgIC8vIE5vdywgd2UgaGF2ZSB0byByZXBsYWNlIHRoZSB2YWx1ZSBvZiB0aGUgbm9kZSB3ZSB3YW50IHRvIHJlbW92ZSB3aXRoIHRoZSBcclxuICAgICAgICAvLyB2YWx1ZSBvZiB0aXMgc3VjY2Vzc29yICh0aGUgc21hbGxlc3QgdmFsdWUgaW4gdGhlIHJpZ2h0IHN1YiB0cmVlKVxyXG4gICAgICAgIC8vIFRoZW4sIERlbGV0ZSB0aGUgc3VjY2Vzc29yIG5vZGUgaW5zdGVhZCBvZiB0aGUgb3JpZ2luYWwgbm9kZSB5b3Ugd2FudCB0byByZW1vdmUgICAgICAgXHJcblxyXG4gICAgICAgIGlmKG5vZGUucmlnaHQgIT0gbnVsbCAmJiBub2RlLmxlZnQgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICBjb25zdCBzdWNjZXNzb3IgPSB0aGlzLmZpbmRTdWNjZXNzb3Iobm9kZS5yaWdodCk7XHJcbiAgICAgICAgICAgIG5vZGUuZGF0YSA9IHN1Y2Nlc3Nvci5kYXRhO1xyXG4gICAgICAgICAgICBub2RlLnJpZ2h0ID0gdGhpcy5kZWxldGUoc3VjY2Vzc29yLmRhdGEsIG5vZGUucmlnaHQpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgcmV0dXJuIG5vZGU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcblxyXG4gICAgZmluZCh2YWwpIHtcclxuICAgICAgICBsZXQgbm9kZSA9IHRoaXMucm9vdDtcclxuICAgICAgICB3aGlsZShub2RlICE9IG51bGwgJiYgbm9kZS5kYXRhICE9IHZhbCkge1xyXG4gICAgICAgICAgICBpZih2YWwgPiBub2RlLmRhdGEpIHtcclxuICAgICAgICAgICAgICAgIG5vZGUgPSBub2RlLnJpZ2h0O1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgbm9kZSA9IG5vZGUubGVmdDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIG5vZGU7XHJcblxyXG4gICAgfVxyXG5cclxuXHJcbiAgICBncmFwaCgpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyh0aGlzLnJvb3QpO1xyXG4gICAgICAgIHByZXR0eVByaW50KHRoaXMucm9vdCk7XHJcbiAgICB9XHJcblxyXG4gICAgZmluZFN1Y2Nlc3Nvcihyb290KSB7XHJcbiAgICAgICAgbGV0IG5vZGUgPSByb290O1xyXG4gICAgICAgIHdoaWxlIChub2RlLmxlZnQgIT0gbnVsbCkge1xyXG4gICAgICAgICAgbm9kZSA9IG5vZGUubGVmdDtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG5vZGU7XHJcbiAgICB9XHJcblxyXG4gICAgbGV2ZWxPcmRlcihub2RlID0gdGhpcy5yb290KSB7XHJcbiAgICAgICAgLy8gVHJhdmVyc2UgdGhlIFRyZWUgaW4gQkZTXHJcbiAgICAgICAgaWYobm9kZSA9PSBudWxsIHx8IG5vZGUuZGF0YSA9PSBudWxsKSBcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgXHJcbiAgICAgICAgbGV0IHF1ZXVlID0gW107XHJcblxyXG4gICAgICAgIHF1ZXVlLnB1c2gobm9kZSk7XHJcblxyXG4gICAgICAgIHdoaWxlKHF1ZXVlLmxlbmd0aCAhPT0gMCkge1xyXG4gICAgICAgICAgICBsZXQgY3VycmVudCA9IHF1ZXVlWzBdOyAgICAgLy8gcHJpbnQgdGhlIGZpcnN0IGluc2VydGVkIGVsZW1lbnQgKGZyb250KVxyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhjdXJyZW50LmRhdGEpO1xyXG4gICAgICAgICAgICBpZihjdXJyZW50LmxlZnQgIT0gbnVsbClcclxuICAgICAgICAgICAgICAgIHF1ZXVlLnB1c2goY3VycmVudC5sZWZ0KTtcclxuICAgICAgICAgICAgaWYoY3VycmVudC5yaWdodCAhPSBudWxsKSBcclxuICAgICAgICAgICAgICAgIHF1ZXVlLnB1c2goY3VycmVudC5yaWdodCk7XHJcbiAgICAgICAgICAgIHF1ZXVlLnNoaWZ0KCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gbnVsbDsgICAgICAgIFxyXG4gICAgfVxyXG5cclxuXHJcbiAgICBcclxufVxyXG5cclxuXHJcblxyXG5leHBvcnQgeyBUcmVlIH07IiwiXHJcblxyXG5cclxuZnVuY3Rpb24gaW5PcmRlcihyb290KSB7XHJcbiAgICBpZihyb290ID09IG51bGwgfHwgcm9vdC5kYXRhID09IG51bGwpIHtcclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuICAgIGluT3JkZXIocm9vdC5sZWZ0KTsgICAgICAgICAvLyBUcmF2ZXJzZSB0aGUgTGVmdCBzdWJUcmVlXHJcbiAgICBjb25zb2xlLmxvZyhyb290LmRhdGEpOyAgICAgLy8gcHJpbnQgdGhlIGRhdGEgb2YgdGhlIGN1cnJlbnQgbm9kZVxyXG4gICAgaW5PcmRlcihyb290LnJpZ2h0KTsgICAgICAgIC8vIFRyYXZlcnNlIHRoZSByaWdodCBzdWJUcmVlXHJcbn1cclxuXHJcblxyXG5leHBvcnQgeyBpbk9yZGVyIH07IiwiXHJcblxyXG5mdW5jdGlvbiBwcmVPcmRlcihyb290KSB7XHJcblx0Ly8gYmFzZSBjYXNlXHJcblx0aWYocm9vdCA9PSBudWxsIHx8IHJvb3QuZGF0YSA9PSBudWxsKVxyXG5cdFx0cmV0dXJuO1xyXG5cclxuXHQvLyBGaXJzdCwgcHJpbnQgdGhlIGRhdGEgaW4gdGhlIGN1cnJlbnQgbm9kZVxyXG5cdGNvbnNvbGUubG9nKHJvb3QuZGF0YSk7XHJcblx0Ly8gVGhlbiwgVHJhdmVyc2UgdGhlIGxlZnQgU3ViVHJlZVxyXG5cdHByZU9yZGVyKHJvb3QubGVmdCk7XHJcblx0Ly8gVGhlbiwgVHJhdmVyc2UgdGhlIHJpZ2h0IFN1YlRyZWVcclxuXHRwcmVPcmRlcihyb290LnJpZ2h0KTtcclxufVxyXG5cclxuXHJcbmV4cG9ydCB7IHByZU9yZGVyIH07IiwiXHJcblxyXG5mdW5jdGlvbiBwb3N0T3JkZXIocm9vdCkge1xyXG4gICAgaWYoIXJvb3QgfHwgIXJvb3QuZGF0YSlcclxuICAgICAgICByZXR1cm47XHJcbiAgICBwb3N0T3JkZXIocm9vdC5sZWZ0KTtcclxuICAgIHBvc3RPcmRlcihyb290LnJpZ2h0KTtcclxuICAgIGNvbnNvbGUubG9nKHJvb3QuZGF0YSk7XHJcbn1cclxuXHJcbmV4cG9ydCB7IHBvc3RPcmRlciB9OyJdLCJuYW1lcyI6WyJwcmV0dHlQcmludCIsIm5vZGUiLCJwcmVmaXgiLCJpc0xlZnQiLCJyaWdodCIsImNvbnNvbGUiLCJsb2ciLCJkYXRhIiwibGVmdCIsIk5vZGUiLCJjb25zdHJ1Y3RvciIsInZhbCIsInRoaXMiLCJhcnIiLCJzdGFydCIsImVuZCIsIm1pZCIsIk1hdGgiLCJmbG9vciIsImhlaWdodCIsIm1heCIsImRlcHRoIiwicm9vdCIsImlzQmFsYW5jZWQiLCJoZWlnaHQxIiwiaGVpZ2h0MiIsImFicyIsInRyYXZlcnNlIiwidW5kZWZpbmVkIiwicHVzaCIsInNvcnQiLCJhIiwiYiIsIm4iLCJsZW5ndGgiLCJuZXdBcnIiLCJpIiwic29ydEFuZFJlbW92ZUR1cGxpY2F0ZXMiLCJ0cmVlIiwiaW5zZXJ0IiwicGFyc2VJbnQiLCJkZWxldGUiLCJzdWNjZXNzb3IiLCJmaW5kU3VjY2Vzc29yIiwiZmluZCIsImdyYXBoIiwibGV2ZWxPcmRlciIsInF1ZXVlIiwiY3VycmVudCIsInNoaWZ0IiwiaW5PcmRlciIsInByZU9yZGVyIiwicG9zdE9yZGVyIiwicmViYWxhbmNlIl0sInNvdXJjZVJvb3QiOiIifQ==